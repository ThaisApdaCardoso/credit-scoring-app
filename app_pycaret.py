# -*- coding: utf-8 -*-
"""Untitled26.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1vnVDU21IvM8_FxnLH62iOaLm8kKoYqm6
"""

import streamlit as st
import pandas as pd
from pycaret.classification import load_model, predict_model

st.set_page_config(page_title="Credit Scoring", layout="wide")
st.title("ğŸ¦ Credit Scoring App ")

# ğŸ“ Upload do arquivo
uploaded_file = st.file_uploader("Envie o arquivo .ftr", type=["ftr"])

# ğŸ“¦ Carregar modelo salvo pelo PyCaret
@st.cache_resource
def carregar_modelo():
    return load_model("modelo_lightgbm_pycaret")

modelo = carregar_modelo()

# âœ… Quando o arquivo for enviado
if uploaded_file is not None:
    df = pd.read_feather(uploaded_file)

    st.subheader("ğŸ“„ Dados carregados:")
    st.dataframe(df.head())

    # ğŸ”® PrevisÃµes
    try:
    resultado = predict_model(modelo, data=df)
    st.subheader("ğŸ“Š Dados com previsÃµes:")
    st.dataframe(resultado.head())

    # Download opcional
    csv = resultado.to_csv(index=False).encode("utf-8")
    st.download_button("â¬‡ï¸ Baixar resultado como CSV", data=csv, file_name="previsoes.csv", mime="text/csv")

except Exception as e:
    st.error(f"Erro ao aplicar o modelo: {e}")

    # ğŸ’¾ BotÃ£o de download
    csv = resultado.to_csv(index=False).encode("utf-8")
    st.download_button(
        label="â¬‡ï¸ Baixar resultado como CSV",
        data=csv,
        file_name="resultado_escoragem.csv",
        mime="text/csv"
    )
